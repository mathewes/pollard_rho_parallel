Function: bnrL1
Section: number_fields
C-Name: bnrL1
Prototype: GDGD0,L,p
Help: bnrL1(bnr, {subgrp}, {flag=0}): bnr being output by bnrinit(,,1) and
 subgrp being a square matrix defining a congruence subgroup of bnr (the
 trivial subgroup if omitted), for each character of bnr trivial on this
 subgroup, compute L(1, chi) (or equivalently the first non-zero term c(chi)
 of the expansion at s = 0). The binary digits of flag mean 1: if 0 then
 compute the term c(chi) and return [r(chi), c(chi)] where r(chi) is the
 order of L(s, chi) at s = 0, or if 1 then compute the value at s = 1 (and in
 this case, only for non-trivial characters), 2: if 0 then compute the value
 of the primitive L-function associated to chi, if 1 then compute the value
 of the L-function L_S(s, chi) where S is the set of places dividing the
 modulus of bnr (and the infinite places), 3: return also the characters.
Doc: \var{bnr} being
 the number field data which is output by \kbd{bnrinit(,,1)} and
 \var{subgrp} being a square matrix defining a congruence subgroup of the
 ray class group corresponding to \var{bnr} (the trivial congruence subgroup
 if omitted), returns for each \idx{character} $\chi$ of the ray class group
 which is trivial on this subgroup, the value at $s = 1$ (or $s = 0$) of the
 abelian $L$-function associated to $\chi$. For the value at $s = 0$, the
 function returns in fact for each character $\chi$ a vector $[r_\chi ,
 c_\chi]$ where $r_\chi$ is the order of $L(s, \chi)$ at $s = 0$ and $c_\chi$
 the first non-zero term in the expansion of $L(s, \chi)$ at $s = 0$; in other
 words
 %
 $$L(s, \chi) = c_\chi \cdot s^{r_\chi} + O(s^{r_\chi + 1})$$
 %
 \noindent near $0$. \fl\ is optional, default value is 0; its binary digits
 mean 1: compute at $s = 1$ if set to 1 or $s = 0$ if set to 0, 2: compute the
 primitive $L$-functions associated to $\chi$ if set to 0 or the $L$-function
 with Euler factors at prime ideals dividing the modulus of \var{bnr} removed
 if set to 1 (this is the so-called $L_S(s, \chi)$ function where $S$ is the
 set of infinite places of the number field together with the finite prime
 ideals dividing the modulus of \var{bnr}, see the example below), 3: returns
 also the character. Example:
 \bprog
 bnf = bnfinit(x^2 - 229);
 bnr = bnrinit(bnf,1,1);
 bnrL1(bnr)
 @eprog\noindent
 returns the order and the first non-zero term of the abelian
 $L$-functions $L(s, \chi)$ at $s = 0$ where $\chi$ runs through the
 characters of the class group of $\Q(\sqrt{229})$. Then
 \bprog
 bnr2 = bnrinit(bnf,2,1);
 bnrL1(bnr2,,2)
 @eprog\noindent
 returns the order and the first non-zero terms of the abelian
 $L$-functions $L_S(s, \chi)$ at $s = 0$ where $\chi$ runs through the
 characters of the class group of $\Q(\sqrt{229})$ and $S$ is the set
 of infinite places of $\Q(\sqrt{229})$ together with the finite prime
 $2$. Note that the ray class group modulo $2$ is in fact the class
 group, so \kbd{bnrL1(bnr2,0)} returns exactly the same answer as
 \kbd{bnrL1(bnr,0)}.
